#!/bin/bash

# Author: devjanger
# Description: This script checks if the XZ version is vulnerable to CVE-2021-35042
# Date: 2024-04-02

# Colors
RED='\033[0;31m'
GREEN='\033[0;32m'
NC='\033[0m'

# Checking if XZ is installed
if ! command -v xz &> /dev/null; then
  echo -e "XZ is not installed"
  exit 1
fi

# Fetching XZ version
xz_version=$(xz --version | awk '{print $4}')

# Checking if the version is vulnerable
if [[ "$xz_version" == "5.6.0" || "$xz_version" == "5.6.1" ]]; then
  echo -e "${RED}XZ version is vulnerable${NC}"
else
  echo -e "${GREEN}XZ version is not vulnerable${NC}"
fi
